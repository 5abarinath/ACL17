<!DOCTYPE html>
<html>

<head>
    <title>ACL '19</title>
    <link href="../css/login.css" rel="stylesheet">
    <!-- Custom Css -->
    <link href="../css/style.css" rel="stylesheet">
</head>

<body>
    <div class="loginBox">
        <h1>ACL '19</h1>
        <h5>Ace Cricket League,2019</h5>
        <br><br>
        <h2>Sign In</h2>

        <p>Username</p>
        <input type="text" class="form-control" name="username" placeholder="Username" id="username" required>
        <br><br>

        <p>Password</p>
        <input type="password" class="form-control" name="password" placeholder="Password" id="password" required>
        <center><button name="btn" onclick="validateAndAuthenticate();">Submit</button></center>

    </div>
    <div class="blur-background"></div>
    </div>

    <!-- Jquery Core Js -->
    <script src="../plugins/jquery/jquery.min.js"></script>

    <!-- Bootstrap Core Js -->
    <script src="../plugins/bootstrap/js/bootstrap.js"></script>

    <!-- JQuery redirect plugin-->
    <script src="../plugins/jquery-redirect/jquery.redirect.js"></script>

    <!-- Waves Effect Css -->
    <link href="../plugins/node-waves/waves.css" rel="stylesheet" />

    <!-- Custom Js -->
    <script src="../js/admin.js"></script>
    <script src="../js/pages/examples/sign-in.js"></script>
    <script src="../js/pages/forms/basic-form-elements.js"></script>
    <!-- Swal plugin Core Js -->
    <script src="../plugins/sweetalert/dist/sweetalert.min.js"></script>

    <script type="text/javascript">
        function validateAndAuthenticate() {

            var user = document.getElementById("username").value.trim();
            var password = document.getElementById("password").value.trim();

            if (user && password) {
                const url = "./authenticate";
                const response = $.post(url, { username: user, password: password } );
                response.success(function(results) {
                    if(results['data']['authenticated']) {
                        swal({
                                title: 'Success!',
                                text: 'Logging you in...',
                                icon: 'success',
                            }).then(
                                function() {
                                    var formTest = document.createElement('form');
                                    formTest.setAttribute("method", "post");
                                    formTest.setAttribute("action", "./control");
                                    document.body.appendChild(formTest);
                                    formTest.submit();
                                }
                            );
                    } else {
                        swal('Oops...', 'Incorrect username or password!', 'error');
                    }
                });
                response.error(function() {
                    swal('Oops...', 'Please check your connection to the server.', 'error');
                });
            }
        }
    </script>

</body>

</html>